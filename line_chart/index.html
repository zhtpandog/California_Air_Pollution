<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>line</title>
		<script type="text/javascript" src="http://d3js.org/d3.v4.min.js" charset="utf-8"></script>
		<style type="text/css">
			/* No style rules here yet */
		</style>
	</head>
	<body>

		<div class="line"></div>

		<script type="text/javascript">

			var w = 1000;
			var h = 600;
			var padding = 100
			var timestamp = ['00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00', '22:00', '23:00']

			interval = (w - 2 * padding) / 23
			xRange = []
			for (var i = 0; i < timestamp.length; i++) {
				xRange.push(padding + interval * i);
			}


			d3.json("line_example.json", function(json) {
	            point = "0009"
	            date = "2017-01-01"
	            no2 = json[point]["NO2"][date]
	            so2 = json[point]["SO2"][date]
	            co = json[point]["CO"][date]
	            // console.log(no2)

	            createLine(no2);
	            createLine(so2);
	            createLine(co);

            })

            var createLine = function(json) {

            	timeAndVal = []
            	for (i in json) {
            		timeAndVal.push([i, parseFloat(json[i])]);
            	}

            	console.log(timeAndVal)


            	var yScale = d3.scaleLinear()
            					.domain([0, d3.max(timeAndVal, function(d) {return d[1];})])
            					.range([h - padding, padding])

            	var xScale = d3.scaleOrdinal()
	            				.domain(timestamp)
	            				.range(xRange)

	            var svg = d3.select("body")
	            			.select(".line")
	            			.append("svg")
	            			.attr("width", w)
	            			.attr("height", h)

	            svg.selectAll("line")
	            	.data(timeAndVal)
	            	.enter()
	            	.append("line")
	            	.attr("x1", function(d, i) {
	            		return xScale(d[0]);
	            	})
	            	.attr("y1", function(d, i) {
	            		return yScale(d[1]);
	            	})
	            	.attr("x2", function(d, i) {
	            		if (i + 1 < timeAndVal.length) {
	            			return xScale(timeAndVal[i + 1][0]);
	            		} 
	            		else {
	            			return xScale(d[0]);
	            		}
	            	})
	            	.attr("y2", function(d, i) {
	            		if (i + 1 < timeAndVal.length) {
	            			return yScale(timeAndVal[i + 1][1]);
	            		}
	            		else {
	            			return yScale(d[1]);
	            		}
	            	})
	            	.attr("stroke-width", 2)
	            	.attr("stroke", "black")

	            var xAxis = d3.axisBottom()
	                            .scale(xScale);

	            svg.append("g")
	                .attr("class", "axis")
	                .attr("transform", "translate(0," + (h-padding) + ")")
	                .call(xAxis);

	            var yAxis = d3.axisLeft()
	                            .scale(yScale);

	            svg.append("g")
	                .attr("class", "axis")
	                .attr("transform", "translate(" + padding + ",0)")
	                .call(yAxis);

            }
			
		</script>
	</body>
</html>